<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><link href=https://guylewin.com/rss.xml rel=alternate title=RSS type=application/rss+xml><title>Guy Lewin's Blog | UniFi Static IP Leases</title><link as=style href=https://guylewin.com/css/style.css rel=preload><link crossorigin href=https://raw.githack.com/Speyll/suCSS/main/reset-min.css rel=stylesheet><link crossorigin href=https://raw.githack.com/Speyll/suCSS/main/suCSS-min.css rel=stylesheet><link href=https://guylewin.com/css/style.css rel=stylesheet><link href=https://guylewin.com/css/custom.css rel=stylesheet><link href=https://guylewin.com/favicon.ico rel=icon><script src="https://www.googletagmanager.com/gtag/js?id=G-YEJ89F03YG" async></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-YEJ89F03YG');</script><meta content="Methods for retrieving and viewing static IP lease allocations from a UniFi network controller, including SSH access to configuration files and the legacy Insights page." name=description><meta content="Methods for retrieving and viewing static IP lease allocations from a UniFi network controller, including SSH access to configuration files and the legacy Insights page." property=og:description><meta content="Methods for retrieving and viewing static IP lease allocations from a UniFi network controller, including SSH access to configuration files and the legacy Insights page." name=twitter:description><meta content="dhcp, ip, jq, ssh, static, ubiquiti, unifi" name=keywords><meta content=Zola name=generator><meta content=English name=language><meta content="index, follow" name=robots><meta content="index, follow" name=googlebot><meta content=en_US property=og:locale><meta content="Guy Lewin's Blog" property=og:site_name><meta content="Guy Lewin's Blog | UniFi Static IP Leases" property=og:title><meta content=https://guylewin.com/blog/2021-07-11-unifi-static-ip-leases/ property=og:url><meta content=article property=og:type><meta content=summary_large_image name=twitter:card><meta content="Guy Lewin's Blog | UniFi Static IP Leases" name=twitter:title><link href=https://guylewin.com/blog/2021-07-11-unifi-static-ip-leases/ rel=canonical><meta content="Guy Lewin" name=author><meta content="Guy Lewin" property=og:author><meta content=2021-07-11T00:00:00Z property=article:published_time><meta content="Guy Lewin" property=article:author><meta content=Blog property=article:section><meta content=dhcp property=article:tag><meta content=ip property=article:tag><meta content=jq property=article:tag><meta content=ssh property=article:tag><meta content=static property=article:tag><meta content=ubiquiti property=article:tag><meta content=unifi property=article:tag><script type=application/ld+json>
{
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "UniFi Static IP Leases",
    
    "author": {
        "@type": "Person",
        "name": "Guy Lewin"
    },
    
    
    "datePublished": "2021-07-11",
    
    "description": "Methods for retrieving and viewing static IP lease allocations from a UniFi network controller, including SSH access to configuration files and the legacy Insights page.",
    "publisher": {
        "@type": "Organization",
        "name": "Guy Lewin&#x27;s Blog"
    }
}
</script><body><nav id=nav-bar><div class=nav-social><a class=icon-link href=https://www.threads.com/@guylewin target=_blank><svg class=icon><use href=https://guylewin.com/icons.svg#threads></use></svg></a><a class=icon-link href=https://www.linkedin.com/in/guy-lewin-48b00712 target=_blank><svg class=icon><use href=https://guylewin.com/icons.svg#linkedin></use></svg></a><a class=icon-link href=https://github.com/GuyLewin target=_blank><svg class=icon><use href=https://guylewin.com/icons.svg#github></use></svg></a><a class=icon-link href=mailto:contact@guylewin.com target=_blank><svg class=icon><use href=https://guylewin.com/icons.svg#email></use></svg></a></div><div class=nav-menu><a href=/> /blog/ </a><a href=/about> /about/ </a></div><div class=nav-controls><div aria-label="Toggle theme" class=theme-toggle data-icon-base=https://guylewin.com/icons.svg data-icon-dark=#darkMode data-icon-light=#lightMode data-sound-src=https://guylewin.com/click.ogg id=theme-toggle role=button tabindex=0><svg class=icon><use id=theme-icon></use></svg></div></div></nav><main><article class=post><header class=post-header><time datetime=2021-07-11>Published on: <span class=accent-data>2021-07-11</span> </time><address rel=author>By <span class=accent-data>Guy Lewin</span></address><h1>UniFi Static IP Leases</h1></header><div class=post-content><p>In order to organize my UniFi-controlled network, I tried to look at all the static IP allocations I made using the UniFi portal.<p>Some lookups online suggested I use the "Insights" page on the UniFi portal, but I get a "No WiFi Networks found" error when I do:<p><img alt src=/images/posts/unifi-static-ip-leases/1.png><p>I figured thereâ€™s a way to get the info through SSHing into the machine itself. Running <code>grep</code> recursively throughout the filesystem made me find <code>/config/ubios-udapi-server/ubios-udapi-server.state</code> which is a large JSON file containing device configuration. The DHCP static leases were listed under <code>services</code> -> <code>dhcpServers</code> -> <code>staticLeases</code>. I wrote this small one-liner to retrieve the mapping as JSON array:<pre class=giallo style=color:#e1e4e8;background-color:#24292e><code data-lang=shellscript><span class=giallo-l><span style=color:#b392f0>cat</span><span style=color:#9ecbff> /config/ubios-udapi-server/ubios-udapi-server.state</span><span style=color:#f97583> |</span><span style=color:#b392f0> jq</span><span style=color:#9ecbff> '[.services.dhcpServers[0].staticLeases[] | {ip: .addresses[0], mac: .id}] | sort_by(.ip | split(".") | map(tonumber))'</span></span></code></pre><p>The output of this script is a JSON array of objects containing <code>ip</code> and <code>mac</code>, for example:<pre class=giallo style=color:#e1e4e8;background-color:#24292e><code data-lang=json><span class=giallo-l><span>[</span></span>
<span class=giallo-l><span>  {</span></span>
<span class=giallo-l><span style=color:#79b8ff>    "ip"</span><span>:</span><span style=color:#9ecbff> "192.168.1.2"</span><span>,</span></span>
<span class=giallo-l><span style=color:#79b8ff>    "mac"</span><span>:</span><span style=color:#9ecbff> "00:11:22:33:44:55"</span></span>
<span class=giallo-l><span>  },</span></span>
<span class=giallo-l><span>  {</span></span>
<span class=giallo-l><span style=color:#79b8ff>    "ip"</span><span>:</span><span style=color:#9ecbff> "192.168.1.3"</span><span>,</span></span>
<span class=giallo-l><span style=color:#79b8ff>    "mac"</span><span>:</span><span style=color:#9ecbff> "aa:bb:cc:dd:ee:ff"</span></span>
<span class=giallo-l><span>  }</span></span>
<span class=giallo-l><span>]</span></span></code></pre><p>Eventually I learned that the old UniFi network UI has a working Insights page containing all the static leases. In order to view this page, I had to go to the "System Settings" tab within the Network settings page and disable "New User Interface":<p><img alt src=/images/posts/unifi-static-ip-leases/2.png><p>Once I did that, I could visit the old Insights page and select the following filters to view all assigned static IP leases:<p><img alt src=/images/posts/unifi-static-ip-leases/3.png></div><div class=post-tags><a class=tag href=/tags/dhcp>#dhcp</a><a class=tag href=/tags/ip>#ip</a><a class=tag href=/tags/jq>#jq</a><a class=tag href=/tags/ssh>#ssh</a><a class=tag href=/tags/static>#static</a><a class=tag href=/tags/ubiquiti>#ubiquiti</a><a class=tag href=/tags/unifi>#unifi</a></div><div class=post-nav><a class=previous href=https://guylewin.com/blog/2021-09-16-bathroom-smart-speaker-using-ue-boom-raspberry-pi-spotify-and-home-assistant/><svg class=icon><use href=https://guylewin.com/icons.svg#chevronLeft></use></svg> Next Project</a><a class=next href=https://guylewin.com/blog/2020-10-27-inconsistencies-in-grpc-java-error-handling-with-bidirectional-streams/>Previous Project <svg class=icon><use href=https://guylewin.com/icons.svg#chevronRight></use></svg></a></div></article></main><footer><hr><div id=footer-container><p>Made using <a rel="noopener noreferrer" href=https://github.com/Speyll/anemone target=_blank>anemone</a> Zola theme</div></footer><script defer src=https://guylewin.com/js/script.js></script>