<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><link href=https://guylewin.com/rss.xml rel=alternate title=RSS type=application/rss+xml><title>Guy Lewin's Blog | Bathroom Smart Speaker using UE Boom, Raspberry Pi, Spotify and Home Assistant</title><link as=style href=https://guylewin.com/css/style.css rel=preload><link crossorigin href=https://raw.githack.com/Speyll/suCSS/main/reset-min.css rel=stylesheet><link crossorigin href=https://raw.githack.com/Speyll/suCSS/main/suCSS-min.css rel=stylesheet><link href=https://guylewin.com/css/style.css rel=stylesheet><link href=https://guylewin.com/css/custom.css rel=stylesheet><link href=https://guylewin.com/favicon.ico rel=icon><script src="https://www.googletagmanager.com/gtag/js?id=G-YEJ89F03YG" async></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-YEJ89F03YG');</script><meta content="Building a smart speaker system that can play music on demand from Home Assistant and support Spotify Connect connectivity using a Raspberry Pi and Bluetooth speaker." name=description><meta content="Building a smart speaker system that can play music on demand from Home Assistant and support Spotify Connect connectivity using a Raspberry Pi and Bluetooth speaker." property=og:description><meta content="Building a smart speaker system that can play music on demand from Home Assistant and support Spotify Connect connectivity using a Raspberry Pi and Bluetooth speaker." name=twitter:description><meta content="home assistant, pi-btaudio, raspberry pi, raspotify, spotcast, spotify, ue boom" name=keywords><meta content=Zola name=generator><meta content=English name=language><meta content="index, follow" name=robots><meta content="index, follow" name=googlebot><meta content=en_US property=og:locale><meta content="Guy Lewin's Blog" property=og:site_name><meta content="Guy Lewin's Blog | Bathroom Smart Speaker using UE Boom, Raspberry Pi, Spotify and Home Assistant" property=og:title><meta content=https://guylewin.com/blog/2021-09-16-bathroom-smart-speaker-using-ue-boom-raspberry-pi-spotify-and-home-assistant/ property=og:url><meta content=article property=og:type><meta content=summary_large_image name=twitter:card><meta content="Guy Lewin's Blog | Bathroom Smart Speaker using UE Boom, Raspberry Pi, Spotify and Home Assistant" name=twitter:title><link href=https://guylewin.com/blog/2021-09-16-bathroom-smart-speaker-using-ue-boom-raspberry-pi-spotify-and-home-assistant/ rel=canonical><meta content="Guy Lewin" name=author><meta content="Guy Lewin" property=og:author><meta content=2021-09-16T00:00:00Z property=article:published_time><meta content="Guy Lewin" property=article:author><meta content=Blog property=article:section><meta content="home assistant" property=article:tag><meta content=pi-btaudio property=article:tag><meta content="raspberry pi" property=article:tag><meta content=raspotify property=article:tag><meta content=spotcast property=article:tag><meta content=spotify property=article:tag><meta content="ue boom" property=article:tag><script type=application/ld+json>
{
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "Bathroom Smart Speaker using UE Boom, Raspberry Pi, Spotify and Home Assistant",
    
    "author": {
        "@type": "Person",
        "name": "Guy Lewin"
    },
    
    
    "datePublished": "2021-09-16",
    
    "description": "Building a smart speaker system that can play music on demand from Home Assistant and support Spotify Connect connectivity using a Raspberry Pi and Bluetooth speaker.",
    "publisher": {
        "@type": "Organization",
        "name": "Guy Lewin&#x27;s Blog"
    }
}
</script><body><nav id=nav-bar><div class=nav-social><a class=icon-link href=https://www.threads.com/@guylewin target=_blank><svg class=icon><use href=https://guylewin.com/icons.svg#threads></use></svg></a><a class=icon-link href=https://www.linkedin.com/in/guy-lewin-48b00712 target=_blank><svg class=icon><use href=https://guylewin.com/icons.svg#linkedin></use></svg></a><a class=icon-link href=https://github.com/GuyLewin target=_blank><svg class=icon><use href=https://guylewin.com/icons.svg#github></use></svg></a><a class=icon-link href=mailto:contact@guylewin.com target=_blank><svg class=icon><use href=https://guylewin.com/icons.svg#email></use></svg></a></div><div class=nav-menu><a href=/> /blog/ </a><a href=/about> /about/ </a></div><div class=nav-controls><div aria-label="Toggle theme" class=theme-toggle data-icon-base=https://guylewin.com/icons.svg data-icon-dark=#darkMode data-icon-light=#lightMode data-sound-src=https://guylewin.com/click.ogg id=theme-toggle role=button tabindex=0><svg class=icon><use id=theme-icon></use></svg></div></div></nav><main><article class=post><header class=post-header><time datetime=2021-09-16>Published on: <span class=accent-data>2021-09-16</span> </time><address rel=author>By <span class=accent-data>Guy Lewin</span></address><h1>Bathroom Smart Speaker using UE Boom, Raspberry Pi, Spotify and Home Assistant</h1></header><div class=post-content><h2 id=goal>Goal</h2><p>We’re going to build a smart speaker system that can play tropical forest sounds (or any other Spotify playlist) on demand from Home Assistant, and support Spotify Connect connectivity to cast music from other Spotify clients (if you want to put your own music while showering).<h2 id=why>Why?</h2><p>Who doesn’t like showering with music? And if you already put a speaker in your bathroom, why not put some tropical background sounds while you’re at it?<h2 id=hardware-requirements>Hardware Requirements</h2><p>I’m using the following hardware for my setup:<ul><li><a rel="noopener external" href=https://www.ultimateears.com/en-us/wireless-speakers/boom-3.html target=_blank>UE </a><a rel="noopener external" href=https://www.ultimateears.com/en-us/wireless-speakers/boom-3.html target=_blank>Boom</a> (I’m actually using UE Boom 2 but any UE Boom would work).<li><a rel="noopener external" href=https://www.raspberrypi.org/products/raspberry-pi-zero-w/ target=_blank>Raspberry Pi Zero W</a> (any Raspberry Pi with Bluetooth will work. Make sure it’ll also have WiFi since most bathrooms don’t have an Ethernet port). <ul><li>microSD card and power adapter for the Raspberry Pi.</ul><li>Optional: <a rel="noopener external" href=https://www.aqara.com/us/motion_sensor.html target=_blank>Aqara Motion Sensor</a> + <a rel="noopener external" href=https://www.phoscon.de/en/conbee2 target=_blank>ConBee II</a> (if you want to turn music on / off based on motion).</ul><h2 id=additional-requirements>Additional Requirements</h2><ul><li><a rel="noopener external" href=https://www.home-assistant.io/ target=_blank>Home Assistant</a> installation in LAN.<li>Spotify Premium account.</ul><h2 id=steps>Steps</h2><h3 id=preparing-the-raspberry-pi>Preparing the Raspberry Pi</h3><p>Install <a rel="noopener external" href=https://www.raspberrypi.org/software/ target=_blank>Raspberry Pi OS</a> on your device by using software such as <a rel="noopener external" href=https://www.raspberrypi.org/documentation/computers/getting-started.html#using-raspberry-pi-imager target=_blank>Raspberry Pi Imager</a>. I chose to install the "Raspberry Pi OS with desktop" flavor.<h3 id=installing-raspotify>Installing Raspotify</h3><p>Once the RPi is installed and connected to your local network, connect via SSH and run the following command to install <a rel="noopener external" href=https://github.com/dtcooper/raspotify target=_blank>Raspotify</a> - the Spotify connect server for Raspberry Pi:<pre class=giallo style=color:#e1e4e8;background-color:#24292e><code data-lang=shellscript><span class=giallo-l><span style=color:#6a737d># Install Raspotify</span></span>
<span class=giallo-l><span style=color:#b392f0>curl</span><span style=color:#79b8ff> -sL</span><span style=color:#9ecbff> https://dtcooper.github.io/raspotify/install.sh</span><span style=color:#f97583> |</span><span style=color:#b392f0> sh</span></span></code></pre><p>After installation, edit <code>/etc/default/raspotify</code> to change some parameters:<ul><li>Uncomment (remove the # at the beginning) the line that starts with <code>DEVICE_NAME</code> and name your Spotify connect server (e.g. <code>Bathroom Speaker</code>)<li>Uncomment (remove the # at the beginning) the line that starts with <code>OPTIONS</code> in order to specify your Spotify premium credentials. This is crucial to allow Home Assistant to play music on this speaker</ul><p>The file should look like this (<strong>while changing every <code>&lt;></code> parameter</strong>):<pre class=giallo style=color:#e1e4e8;background-color:#24292e><code data-lang=plain><span class=giallo-l><span># /etc/default/raspotify -- Arguments/configuration for librespot</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span># Device name on Spotify Connect</span></span>
<span class=giallo-l><span>DEVICE_NAME="&lt;Speaker Name>"</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span># The displayed device type in Spotify clients.</span></span>
<span class=giallo-l><span># Can be "unknown", "computer", "tablet", "smartphone", "speaker", "tv",</span></span>
<span class=giallo-l><span># "avr" (Audio/Video Receiver), "stb" (Set-Top Box), and "audiodongle".</span></span>
<span class=giallo-l><span>#DEVICE_TYPE="speaker"</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span># Bitrate, one of 96 (low quality), 160 (default quality), or 320 (high quality)</span></span>
<span class=giallo-l><span>#BITRATE="160"</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span># Additional command line arguments for librespot can be set below.</span></span>
<span class=giallo-l><span># See `librespot -h` for more info. Make sure whatever arguments you specify</span></span>
<span class=giallo-l><span># aren't already covered by other variables in this file. (See the daemon's</span></span>
<span class=giallo-l><span># config at `/lib/systemd/system/raspotify.service` for more technical details.)</span></span>
<span class=giallo-l><span>#</span></span>
<span class=giallo-l><span># To make your device visible on Spotify Connect across the Internet add your</span></span>
<span class=giallo-l><span># username and password which can be set via "Set device password", on your</span></span>
<span class=giallo-l><span># account settings, use `--username` and `--password`.</span></span>
<span class=giallo-l><span>#</span></span>
<span class=giallo-l><span># To choose a different output device (ie a USB audio dongle or HDMI audio out),</span></span>
<span class=giallo-l><span># use `--device` with something like `--device hw:0,1`. Your mileage may vary.</span></span>
<span class=giallo-l><span>#</span></span>
<span class=giallo-l><span>OPTIONS="--username '&lt;Put Spotify Premium Username Here>' --password '&lt;Put Spotify Premium Password Here>'"</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span># Uncomment to use a cache for downloaded audio files. Cache is disabled by</span></span>
<span class=giallo-l><span># default. It's best to leave this as-is if you want to use it, since</span></span>
<span class=giallo-l><span># permissions are properly set on the directory `/var/cache/raspotify'.</span></span>
<span class=giallo-l><span>#CACHE_ARGS="--cache /var/cache/raspotify"</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span># By default, the volume normalization is enabled, add alternative volume</span></span>
<span class=giallo-l><span># arguments here if you'd like, but these should be fine.</span></span>
<span class=giallo-l><span>#VOLUME_ARGS="--enable-volume-normalisation --volume-ctrl linear --initial-volume=100"</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span># Backend could be set to pipe here, but it's for very advanced use cases of</span></span>
<span class=giallo-l><span># librespot, so you shouldn't need to change this under normal circumstances.</span></span>
<span class=giallo-l><span>#BACKEND_ARGS="--backend alsa"</span></span></code></pre><h3 id=installing-pi-btaudio>Installing pi-btaudio</h3><p>pi-btaudio is a suite of packages that allow your RPi to connect to UE Boom automatically, and make sure the connection stays active.<p>Start by going over the <a rel="noopener external" href=https://github.com/bablokb/pi-btaudio#prerequisites target=_blank>prerequisites</a>, make sure to write down the MAC address of your UE Boom. In order to connect to a UE Boom, you must press its Bluetooth pairing button for it to accept new connections.<p>Once you’re done, follow <a rel="noopener external" href=https://github.com/bablokb/pi-btaudio#installation target=_blank>their installation steps</a> to install the tools. Edit the configuration file in <code>/etc/asound.conf</code> with the following content (<strong>make sure you replace <code>&lt;UE Boom Bluetooth MAC></code> with the one found during prerequisites</strong>):<pre class=giallo style=color:#e1e4e8;background-color:#24292e><code data-lang=plain><span class=giallo-l><span>pcm.!default "bluealsa"</span></span>
<span class=giallo-l><span>ctl.!default "bluealsa"</span></span>
<span class=giallo-l><span>defaults.bluealsa.interface "hci0"</span></span>
<span class=giallo-l><span>defaults.bluealsa.device "&lt;UE Boom Bluetooth MAC>"</span></span>
<span class=giallo-l><span>defaults.bluealsa.profile "a2dp"</span></span></code></pre><h3 id=raspotify-watchdog-restarter>Raspotify Watchdog Restarter</h3><p>Providing credentials as options to Raspotify ensures Home Assistant will be able to connect and play music remotely. But after someone else uses Spotify Connect to cast music into Raspotify - it’s unable to reconnect using the credentials provided in the configuration file.<p>To solve this, I wrote a small API server in Python to restart Raspotify once I want to turn it off (when motion sensor turns off).<p>Start by creating a <code>~/watchdog</code> directory and placing the following content in <code>~/watchdog/server.py</code> (<strong>replace <code>&lt;Secret Restart Password QueryString></code> with some long string that should be kept secret</strong>):<pre class=giallo style=color:#e1e4e8;background-color:#24292e><code data-lang=python><span class=giallo-l><span style=color:#f97583>import</span><span> os</span></span>
<span class=giallo-l><span style=color:#f97583>from</span><span> http.server</span><span style=color:#f97583> import</span><span> HTTPServer, BaseHTTPRequestHandler</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#f97583>class</span><span style=color:#b392f0> MyHandler</span><span>(</span><span style=color:#b392f0>BaseHTTPRequestHandler</span><span>):</span></span>
<span class=giallo-l><span style=color:#f97583>    def</span><span style=color:#b392f0> do_GET</span><span>(self):</span></span>
<span class=giallo-l><span style=color:#f97583>        if</span><span style=color:#79b8ff> self</span><span>.path</span><span style=color:#f97583> !=</span><span style=color:#9ecbff> "/?&lt;Secret Restart Password QueryString>"</span><span>:</span></span>
<span class=giallo-l><span style=color:#79b8ff>            self</span><span>.send_response(</span><span style=color:#79b8ff>401</span><span>)</span></span>
<span class=giallo-l><span style=color:#79b8ff>            self</span><span>.end_headers()</span></span>
<span class=giallo-l><span style=color:#79b8ff>            self</span><span>.wfile.write(</span><span style=color:#79b8ff>bytes</span><span>(</span><span style=color:#9ecbff>"Bye bye"</span><span>,</span><span style=color:#9ecbff> "utf-8"</span><span>))</span></span>
<span class=giallo-l><span style=color:#f97583>            return</span></span>
<span class=giallo-l><span style=color:#6a737d>        # send 200 response</span></span>
<span class=giallo-l><span style=color:#79b8ff>        self</span><span>.send_response(</span><span style=color:#79b8ff>200</span><span>)</span></span>
<span class=giallo-l><span style=color:#6a737d>        # send response headers</span></span>
<span class=giallo-l><span style=color:#79b8ff>        self</span><span>.end_headers()</span></span>
<span class=giallo-l><span style=color:#6a737d>        # send the body of the response</span></span>
<span class=giallo-l><span>        os.system(</span><span style=color:#9ecbff>"sudo systemctl restart raspotify.service"</span><span>)</span></span>
<span class=giallo-l><span style=color:#79b8ff>        self</span><span>.wfile.write(</span><span style=color:#79b8ff>bytes</span><span>(</span><span style=color:#9ecbff>"Restarted"</span><span>,</span><span style=color:#9ecbff> "utf-8"</span><span>))</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>httpd</span><span style=color:#f97583> =</span><span> HTTPServer((</span><span style=color:#9ecbff>''</span><span>,</span><span style=color:#79b8ff> 9876</span><span>), MyHandler)</span></span>
<span class=giallo-l><span>httpd.serve_forever()</span></span></code></pre><p>Then create the file <code>/lib/systemd/system/restart_raspotify.service</code> with the following content:<pre class=giallo style=color:#e1e4e8;background-color:#24292e><code data-lang=plain><span class=giallo-l><span>[Unit]</span></span>
<span class=giallo-l><span>Description=Restart raspotify service</span></span>
<span class=giallo-l><span>After=multi-user.target</span></span>
<span class=giallo-l><span>Conflicts=getty@tty1.service</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>[Service]</span></span>
<span class=giallo-l><span>Type=simple</span></span>
<span class=giallo-l><span>ExecStart=/usr/bin/python3 /home/pi/watchdog/server.py</span></span>
<span class=giallo-l><span>StandardInput=tty-force</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>[Install]</span></span>
<span class=giallo-l><span>WantedBy=multi-user.target</span></span></code></pre><p>To enable the newly created service, run:<pre class=giallo style=color:#e1e4e8;background-color:#24292e><code data-lang=shellscript><span class=giallo-l><span style=color:#b392f0>systemctl</span><span style=color:#9ecbff> enable restart_raspotify.service</span></span>
<span class=giallo-l><span style=color:#b392f0>systemctl</span><span style=color:#9ecbff> start restart_raspotify.service</span></span></code></pre><h3 id=spotcast-on-home-assistant>Spotcast on Home Assistant</h3><p>Spotcast enables Home Assistant to play music on Spotify Connect-enabled devices, like our Raspotify system. Follow the <a rel="noopener external" href=https://github.com/fondberg/spotcast#installation target=_blank>installation steps</a> to install on your Home Assistant instance. After installing, you need to configure Home Assistant to authenticate using your Spotify Premium account by following the <a rel="noopener external" href=https://github.com/fondberg/spotcast#configuration target=_blank>configuration steps</a>.<p>After restarting Home Assistant, you’ll be able to use Spotcast to play music on your speaker through Raspotify by calling this Home Assistant service (<strong>replace <code>&lt;Speaker Name></code> with what you specified in <code>/etc/default/raspotify</code>, and <code>&lt;Spotify Playlist URI></code> with the Spotify-formatted URI such as <code>spotify:album:2PPfl28ysMbOkl2DBJ5Dr4</code> - a good rainforest nature album</strong>):<pre class=giallo style=color:#e1e4e8;background-color:#24292e><code data-lang=yaml><span class=giallo-l><span style=color:#85e89d>data</span><span>:</span></span>
<span class=giallo-l><span style=color:#85e89d>  device_name</span><span>:</span><span style=color:#9ecbff> "&lt;Speaker Name>"</span></span>
<span class=giallo-l><span style=color:#85e89d>  random_song</span><span>:</span><span style=color:#79b8ff> true</span></span>
<span class=giallo-l><span style=color:#85e89d>  uri</span><span>:</span><span style=color:#9ecbff> "&lt;Spotify Playlist URI>"</span></span>
<span class=giallo-l><span style=color:#85e89d>  start_volume</span><span>:</span><span style=color:#79b8ff> 15</span></span>
<span class=giallo-l><span style=color:#85e89d>  force_playback</span><span>:</span><span style=color:#79b8ff> true</span></span>
<span class=giallo-l><span style=color:#85e89d>service</span><span>:</span><span style=color:#9ecbff> spotcast.start</span></span></code></pre><h3 id=raspotify-restart-via-home-assistant>Raspotify Restart via Home Assistant</h3><p>Edit Home Assistant’s <code>configuration.yaml</code> file (by <a rel="noopener external" href=https://www.home-assistant.io/getting-started/configuration/ target=_blank>installing the File Editor</a> or by any other method) and insert the following to the configuration (<strong>replace &lt;Secret Restart Password QueryString> with what you chose in <code>~/watchdog/server.py</code></strong>):<pre class=giallo style=color:#e1e4e8;background-color:#24292e><code data-lang=yaml><span class=giallo-l><span style=color:#85e89d>rest_command</span><span>:</span></span>
<span class=giallo-l><span style=color:#85e89d>  restart_raspotify</span><span>:</span></span>
<span class=giallo-l><span style=color:#85e89d>    url</span><span>:</span><span style=color:#9ecbff> "http://&lt;Raspberry Pi IP>:9876/?&lt;Secret Restart Password QueryString>"</span></span></code></pre><p>After another Home Assistant restart, you’ll be able to invoke the following service to restart Raspotify and make it re-authenticate using the configured credentials:<pre class=giallo style=color:#e1e4e8;background-color:#24292e><code data-lang=yaml><span class=giallo-l><span style=color:#85e89d>service</span><span>:</span><span style=color:#9ecbff> rest_command.restart_raspotify</span></span></code></pre><h3 id=connecting-it-all-together-in-home-assistant>Connecting It All Together in Home Assistant</h3><p>I configured an automation to trigger when the motion sensor is activated - it will play the rainforest nature album (<code>spotify:album:2PPfl28ysMbOkl2DBJ5Dr4</code>). When the motion sensor is deactivated - it runs restart_raspotify to reset Raspotify to the configured credentials and be ready for the next person to walk in.<p>If anyone wants the full Home Assistant setup, write a comment and I’ll upload that as well.<h3 id=adding-airplay-support>Adding AirPlay Support</h3><p>Follow the instructions in the <a rel="noopener external" href=https://lewin.co.il/bathroom-smart-speaker-part-2-airplay-to-bluetooth-speaker-via-raspberry-pi/ target=_blank>follow-up post</a>.<h2 id=bonus-turning-ue-boom-on-via-raspberry-pi>Bonus - Turning UE Boom On via Raspberry Pi</h2><p>UE Boom is listening for Bluetooth commands even when turned off. You can use your phone (if paired with the speaker) to turn the speaker on remotely. You can do the same with Raspberry Pi after it’s connected. To do so, first install NodeJS (I chose version 14.15.4 while writing this, there’s probably a newer version available when you’re reading this). There’s no official NodeJS release for Raspberry Pi Zero W, but this unofficial installation works great for me:<pre class=giallo style=color:#e1e4e8;background-color:#24292e><code data-lang=shellscript><span class=giallo-l><span style=color:#6a737d>#!/bin/bash</span></span>
<span class=giallo-l><span style=color:#f97583>export</span><span> NODE_VER</span><span style=color:#f97583>=</span><span style=color:#79b8ff>14.15.4</span></span>
<span class=giallo-l><span style=color:#f97583>if !</span><span style=color:#b392f0> node</span><span style=color:#79b8ff> --version</span><span style=color:#f97583> |</span><span style=color:#b392f0> grep</span><span style=color:#79b8ff> -q</span><span> ${NODE_VER};</span><span style=color:#f97583> then</span></span>
<span class=giallo-l><span>  (</span><span style=color:#b392f0>cat</span><span style=color:#9ecbff> /proc/cpuinfo</span><span style=color:#f97583> |</span><span style=color:#b392f0> grep</span><span style=color:#79b8ff> -q</span><span style=color:#9ecbff> "Pi Zero"</span><span>) &&</span><span style=color:#f97583> if</span><span> [</span><span style=color:#f97583> ! -d</span><span> node-v${NODE_VER}-linux-armv6l ];</span><span style=color:#f97583> then</span></span>
<span class=giallo-l><span style=color:#79b8ff>    echo</span><span style=color:#9ecbff> "Installing nodejs ${</span><span>NODE_VER</span><span style=color:#9ecbff>} for armv6 from unofficial builds..."</span></span>
<span class=giallo-l><span style=color:#b392f0>    curl</span><span style=color:#79b8ff> -O</span><span style=color:#9ecbff> https://unofficial-builds.nodejs.org/download/release/v</span><span>${NODE_VER}</span><span style=color:#9ecbff>/node-v</span><span>${NODE_VER}</span><span style=color:#9ecbff>-linux-armv6l.tar.xz</span></span>
<span class=giallo-l><span style=color:#b392f0>    tar</span><span style=color:#79b8ff> -xf</span><span style=color:#9ecbff> node-v</span><span>${NODE_VER}</span><span style=color:#9ecbff>-linux-armv6l.tar.xz</span></span>
<span class=giallo-l><span style=color:#f97583>  fi</span></span>
<span class=giallo-l><span style=color:#79b8ff>  echo</span><span style=color:#9ecbff> "Adding node to the PATH"</span></span>
<span class=giallo-l><span>  PATH</span><span style=color:#f97583>=</span><span>$(</span><span style=color:#79b8ff>pwd</span><span>)</span><span style=color:#9ecbff>/node-v</span><span>${NODE_VER}</span><span style=color:#9ecbff>-linux-armv6l/bin:</span><span>${PATH}</span></span>
<span class=giallo-l><span style=color:#f97583>fi</span></span></code></pre><p>After installing NodeJS, run the following script whenever you want to turn your UE Boom on. <strong>Make sure you replace 00:11:22:33:44:55 with your UE Boom’s Bluetooth MAC address, and AABBCCDDEEFF to your Raspberry Pi Zero W’s Bluetooth MAC address, the same client address you used for pairing.</strong><pre class=giallo style=color:#e1e4e8;background-color:#24292e><code data-lang=shellscript><span class=giallo-l><span style=color:#6a737d>#!/bin/sh</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#79b8ff>set -ue</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>HANDLE</span><span style=color:#f97583>=</span><span style=color:#9ecbff>0x0003</span></span>
<span class=giallo-l><span>VALUE</span><span style=color:#f97583>=</span><span style=color:#9ecbff>AABBCCDDEEFF01</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>MAC</span><span style=color:#f97583>=</span><span style=color:#9ecbff>00:11:22:33:44:55</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#b392f0>gatttool</span><span style=color:#79b8ff> -b</span><span> $MAC</span><span style=color:#79b8ff> --char-write-req --handle=</span><span>$HANDLE</span><span style=color:#79b8ff> --value=</span><span>$VALUE</span></span></code></pre></div><div class=post-tags><a class=tag href=/tags/home-assistant>#home assistant</a><a class=tag href=/tags/pi-btaudio>#pi-btaudio</a><a class=tag href=/tags/raspberry-pi>#raspberry pi</a><a class=tag href=/tags/raspotify>#raspotify</a><a class=tag href=/tags/spotcast>#spotcast</a><a class=tag href=/tags/spotify>#spotify</a><a class=tag href=/tags/ue-boom>#ue boom</a></div><div class=post-nav><a class=previous href=https://guylewin.com/blog/2021-12-27-winning-the-impossible-race-an-unintended-solution-for-includers-revenge-counter-hxp-2021/><svg class=icon><use href=https://guylewin.com/icons.svg#chevronLeft></use></svg> Next Project</a><a class=next href=https://guylewin.com/blog/2021-07-11-unifi-static-ip-leases/>Previous Project <svg class=icon><use href=https://guylewin.com/icons.svg#chevronRight></use></svg></a></div></article></main><footer><hr><div id=footer-container><p>Made using <a rel="noopener noreferrer" href=https://github.com/Speyll/anemone target=_blank>anemone</a> Zola theme</div></footer><script defer src=https://guylewin.com/js/script.js></script>